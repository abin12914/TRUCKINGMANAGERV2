function setNameValues(){if($("#truck_id").val()){var e=$("#truck_id option:selected").text();$("#truck_reg_number").val(e)}else $("#truck_reg_number").val("");if($("#source_id").val()){var a=$("#source_id option:selected").text();$("#source_name").val(a)}else $("#source_name").val("");if($("#destination_id").val()){var t=$("#destination_id option:selected").text();$("#destination_name").val(t)}else $("#destination_name").val("");if($("#material_id").val()){var r=$("#material_id option:selected").text();$("#material_name").val(r)}else $("#material_name").val("")}function disableSiblings(e,a){a&&"undefined"!=a?($(e).children("option[value="+a+"]").prop("disabled",!0).siblings().prop("disabled",!1),initializeSelect2()):$(e).children().prop("disabled",!1)}function calculateTripRent(){var e;(e=($("#rent_measurement").val()>0?$("#rent_measurement").val():0)*($("#rent_rate").val()>0?$("#rent_rate").val():0))>0?$("#trip_rent").val(e):$("#trip_rent").val(0)}function calculateTotalRent(){var e,a=$("#no_of_trip").val()>0?$("#no_of_trip").val():0;(e=($("#trip_rent").val()>0?$("#trip_rent").val():0)*a)>0?$("#total_rent").val(e):$("#total_rent").val(0)}function calculateDriverWageTotal(){var e,a=$("#no_of_trip").val()>0?$("#no_of_trip").val():0;(e=($("#driver_wage").val()>0?$("#driver_wage").val():0)*a)>0?$("#driver_total_wage").val(e):$("#driver_total_wage").val(0)}function calculateDriverWage(){var e=$("#trip_rent").val(),a=0,t=0,r=$("#driver_id").find(":selected").data("wage-type"),i=$("#driver_id").find(":selected").data("wage-amount")>0?$("#driver_id").find(":selected").data("wage-amount"):0,n=$("#no_of_trip").val()>0?$("#no_of_trip").val():0;if(i>0){switch(r){case 1:a=e*(i/100);break;case 2:a=i;break;case 3:case 4:default:a=0}t=a*n,$("#driver_wage").val(a),$("#driver_total_wage").val(t)}else $("#driver_wage").val(""),$("#driver_total_wage").val("")}function changeMessage(){var e=1;setInterval(function(){1==e?($("#wait_modal_message_1").hide(),$("#wait_modal_message_2").show(),$("#wait_modal_message_3").hide(),e=2):2==e?($("#wait_modal_message_1").hide(),$("#wait_modal_message_2").hide(),$("#wait_modal_message_3").show(),e=3):($("#wait_modal_message_1").show(),$("#wait_modal_message_2").hide(),$("#wait_modal_message_3").hide(),e=1)},4e3)}function driverByTruck(){var e=$("#truck_id").val();e&&$.ajax({url:"/last/transportation",method:"get",data:{truck_id:e,type:"get-driver"},success:function(e){e&&e.flag?($("#driver_id").val(e.employee_id),$("#driver_id").trigger("change")):($("#driver_id").val(""),$("#driver_id").trigger("change"))},error:function(){$("#driver_id").val(""),$("#driver_id").trigger("change")}}),$("#driver_id").val(""),$("#driver_id").trigger("change")}function contractorBySite(){var e=$("#source_id").val(),a=$("#destination_id").val();e&&a&&$.ajax({url:"/last/transportation",method:"get",data:{source_id:e,destination_id:a,type:"get-contractor"},success:function(e){e&&e.flag?($("#contractor_account_id").val(e.contractor_account_id),$("#contractor_account_id").trigger("change")):($("#contractor_account_id").val(""),$("#contractor_account_id").trigger("change"))},error:function(){$("#contractor_account_id").val(""),$("#contractor_account_id").trigger("change")}}),$("#contractor_account_id").val(""),$("#contractor_account_id").trigger("change")}function rentDetailByCombo(){var e=$("#truck_id").val(),a=$("#source_id").val(),t=$("#destination_id").val(),r=$("#contractor_account_id").val();e&&a&&t&&r&&$.ajax({url:"/last/transportation",method:"get",data:{truck_id:e,source_id:a,destination_id:t,contractor_account_id:r,type:"get-measures"},success:function(e){e&&e.flag?($("#rent_type").val(e.rent_type),$("#rent_type").trigger("change"),$("#rent_measurement").val(e.rent_measurement),$("#rent_measurement").trigger("change"),$("#rent_rate").val(e.rent_rate),$("#rent_rate").trigger("change"),$("#material_id").val(e.material_id),$("#material_id").trigger("change")):($("#rent_type").val(""),$("#rent_type").trigger("change"),$("#rent_measurement").val(""),$("#rent_measurement").trigger("change"),$("#rent_rate").val(""),$("#rent_rate").trigger("change"),$("#material_id").val(""),$("#material_id").trigger("change"))},error:function(){$("#rent_type").val(""),$("#rent_type").trigger("change"),$("#rent_measurement").val(""),$("#rent_measurement").trigger("change"),$("#rent_rate").val(""),$("#rent_rate").trigger("change"),$("#material_id").val(""),$("#material_id").trigger("change")}})}$(function(){if(setNameValues(),"undefined"!=$("#source_id").val()){var e=$("#source_id").val(),a=$("#destination_id").val();disableSiblings("#destination_id",e),disableSiblings("#source_id",a)}$("body").on("change","#truck_id",function(){setNameValues(),driverByTruck()}),$("body").on("change","#source_id",function(){setNameValues(),disableSiblings("#destination_id",$("#source_id").val()),contractorBySite()}),$("body").on("change","#destination_id",function(){setNameValues(),disableSiblings("#source_id",$("#destination_id").val()),initializeSelect2(),contractorBySite()}),$("body").on("change","#material_id",function(){setNameValues()}),$("body").on("change","#contractor_account_id",function(){rentDetailByCombo()}),$("body").on("change","#rent_type",function(e){var a=$("#rent_type").val();a&&3==a?($("#rent_measurement").prop("readonly",!0),$("#rent_measurement").val(1)):($("#rent_measurement").prop("readonly",!1),$("#rent_measurement").val("")),calculateTripRent(),calculateDriverWage()}),$("body").on("keyup","#rent_measurement",function(e){calculateTripRent(),calculateDriverWage()}),$("body").on("keyup change","#rent_rate",function(e){calculateTripRent(),calculateDriverWage()}),$("body").on("keyup change","#no_of_trip",function(e){calculateTotalRent(),calculateDriverWageTotal()}),$("body").on("change","#driver_id",function(e){calculateDriverWage()}),$("body").on("keyup change","#driver_wage",function(e){var a=($("#driver_wage").val()>0?$("#driver_wage").val():0)*($("#no_of_trip").val()>0?$("#no_of_trip").val():0);"undefined"!=a&&a>0&&$("#driver_total_wage").val(a)}),$("body").on("click","#save_button",function(e){e.preventDefault(),$("#save_button").prop("disabled",!0),$("#save_button").parents("form:first").submit(),$("#wait_modal").modal("show"),changeMessage()})});
